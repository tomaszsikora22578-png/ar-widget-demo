name: Firebase Hosting CD

on:
  push:
    branches:
      - main  # Akcja uruchomi się po pushu do gałęzi 'main'

jobs:
  build_and_deploy:
    name: Wdrożenie na Firebase Hosting
    runs-on: ubuntu-latest
    
    steps:
      - name: Sprawdzenie kodu (Checkout)
        uses: actions/checkout@v4

      # Używamy oficjalnej akcji Google dla stabilnego wdrożenia
      - name: Wdrożenie na Firebase Hosting
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          # KLUCZOWE: Wprowadzamy poprawne, pełne ID projektu
          projectId: ar-widget-project-5f6f8
          
          # KLUCZOWE: Wymuszamy, by cel wdrożenia był 'ar-widget-prod' (jeśli go zainicjowałeś)
          # Jeśli użyłeś domyślnego celu, zmień tę linię na: target: ar-widget-project-5f6f8
          target: ar-widget-prod 
          
          # KLUCZOWE: Uwierzytelnienie za pomocą Klucza Konta Usługowego
          # Używamy tutaj nazwy zmiennej, której oficjalnie oczekuje akcja Google dla SA Key
          # Skoro TWÓJ sekret to FIREBASE_DEPLOY_TOKEN, musimy go podać:
          serviceAccount: ${{ secrets.FIREBASE_DEPLOY_TOKEN }}
          
          # Upewniamy się, że akcja wie, co ma wdrażać
          entryPoint: .
