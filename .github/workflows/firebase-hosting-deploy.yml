name: Firebase Hosting CD

on:
  push:
    branches:
      - main  # Akcja uruchomi się po pushu do gałęzi 'main'

jobs:
  build_and_deploy:
    name: Wdrożenie na Firebase Hosting
    runs-on: ubuntu-latest
    
    steps:
      - name: Sprawdzenie kodu (Checkout)
        uses: actions/checkout@v4

      # Używamy oficjalnej akcji Google dla stabilnego wdrożenia
      - name: Wdrożenie na Firebase Hosting
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          # KLUCZOWE: Wprowadzamy poprawne, pełne ID projektu
          projectId: ar-widget-project-5f6f8
          
          # KLUCZOWE: Wymuszamy, by cel wdrożenia był 'ar-widget-prod' (jeśli go zainicjowałeś)
          target: ar-widget-prod 
          
          # POPRAWKA NAZEWNICTWA: Zmieniamy 'serviceAccount' na 'firebaseServiceAccount'.
          # Akcja teraz wie, że ten input dostarcza klucz SA.
          firebaseServiceAccount: ${{ secrets.FIREBASE_DEPLOY_TOKEN }}
          
          # Upewniamy się, że akcja wie, co ma wdrażać
          entryPoint: .
