name: Firebase Hosting CI/CD - OSTATECZNA WERSJA

on:
  push:
    branches:
      - main  # Akcja uruchomi się po pushu do gałęzi 'main'

jobs:
  deploy_frontend:
    name: Wdrożenie na Firebase Hosting (Użycie dedykowanej akcji)
    runs-on: ubuntu-latest
    
    steps:
      - name: Sprawdzenie kodu (Checkout)
        uses: actions/checkout@v4
      
      # KLUCZOWA ZMIANA: Używamy akcji stworzonej do wdrażania na Firebase.
      - name: Wdrożenie na Firebase Hosting
        uses: w9jds/firebase-action@master
        with:
          # Wszystkie parametry w komendzie 'args'
          args: deploy --project ar-widget-project --only hosting:ar-widget-project
        env:
          # KLUCZOWA POPRAWKA: Przekazujemy Token do zmiennej środowiskowej FIREBASE_TOKEN,
          # którą ta akcja poprawnie odczytuje i udostępnia CLI.
          FIREBASE_TOKEN: ${{ secrets.FIREBASE_DEPLOY_TOKEN }}
          PROJECT_ID: ar-widget-project
