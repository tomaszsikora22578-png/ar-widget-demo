name: Firebase Hosting CI/CD - OSTATECZNA WERSJA

on:
  push:
    branches:
      - main  # Akcja uruchomi się po pushu do gałęzi 'main'

jobs:
  deploy_frontend:
    name: Wdrożenie na Firebase Hosting (Użycie dedykowanej akcji)
    runs-on: ubuntu-latest
    
    steps:
      - name: Sprawdzenie kodu (Checkout)
        uses: actions/checkout@v4

      # Usunęliśmy instalację Node.js i Firebase CLI przez npm,
      # ponieważ to powodowało błędy ze starą wersją CLI.
      
      # KLUCZOWA ZMIANA: Używamy akcji stworzonej do wdrażania na Firebase.
      - name: Wdrożenie na Firebase Hosting
        uses: w9jds/firebase-action@master
        with:
          # Token Firebase, który Pan wygenerował
          firebaseToken: ${{ secrets.FIREBASE_DEPLOY_TOKEN }}
          # Projekt ID (ID Firebase, a nie nazwa)
          args: deploy --project ar-widget-project --only hosting
          # Wdrożenie domyślnej strony hostingowej
          site: ar-widget-project
          # Katalog, w którym są pliki firebase.json i .firebaserc
          channel: live
        env:
          # Upewniamy się, że to działa w katalogu głównym (gdzie jest index.html)
          PROJECT_ID: ar-widget-project
